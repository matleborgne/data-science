= Code =

<source lang="python3">
def src_targeting(srcPath:str, srcStruct:dict):
    # srcPath   : path of source data
    # srcStruct : label of source type, pattern of source type in files
    
    import pandas as pd, os
    
    # Listing files in directory
    fileList = [os.path.join(root, name) \
    for root, dirs, files in os.walk(srcPath) \
    for name in files]

    # Creation of a source dataframe with categories/type of source
    dfSource = pd.DataFrame()
    for label,pattern in srcStruct.items():
        targetList = pd.Series(fileList)\
            [pd.Series(fileList).str.contains(rf'{pattern}')].values
        dfSource[label] = pd.Series(targetList)
    
    return dfSource
</source>

<source>
Out[]:
|   |                 achats                  |                 ventes                  |
| 0 | ../source/File _ journal-achats_S1.txt  | ../source/File _ journal-ventes_S1.txt  |
| 1 | ../source/File _ journal-achats_S2.txt  | ../source/File _ journal-ventes_S2.txt  |
</source>

= Explications =
